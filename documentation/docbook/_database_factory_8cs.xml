<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<section xmlns="http://docbook.org/ns/docbook" version="5.0" xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="_database_factory_8cs">
    <title>DatabaseFactory.cs File Reference</title>
<para>Include dependency diagram for DatabaseFactory.cs</para>
<para>
    <figure>
        <title>Dependency diagram</title>
        <mediaobject>
            <imageobject>
                <imagedata width="50%" align="center" valign="middle" scalefit="1" fileref="_database_factory_8cs__incl.png"></imagedata>
            </imageobject>
        </mediaobject>
    </figure>
</para>
<para>Included by dependency diagram for DatabaseFactory.cs</para>
<para>
    <figure>
        <title>Dependency diagram</title>
        <mediaobject>
            <imageobject>
                <imagedata width="50%" align="center" valign="middle" scalefit="1" fileref="_database_factory_8cs__dep__incl.png"></imagedata>
            </imageobject>
        </mediaobject>
    </figure>
</para>
        <section>
            <title> Classes </title>
            <para>
                <itemizedlist>
                    <listitem>
                        <para>struct <link linkend="class_configure_one_flag_1_1_database_factory">ConfigureOneFlag::DatabaseFactory</link></para>
<para><emphasis>&lt;summary&gt;
Repository for all database functions and calls on behalf of the assembly
&lt;/summary&gt;</emphasis></para>
                    </listitem>
                </itemizedlist>
            </para>
        </section>
        <simplesect>
            <title> Namespaces </title>
            <para>
                <itemizedlist>
                    <listitem>
                        <para>struct <link linkend="namespace_configure_one_flag">ConfigureOneFlag</link></para>
                    </listitem>
                </itemizedlist>
            </para>
            <para>
                <itemizedlist>
                    <listitem>
                        <para>struct <link linkend="namespace_system_1_1_data_1_1_ole_db">System::Data::OleDb</link></para>
                    </listitem>
                </itemizedlist>
            </para>
            <para>
                <itemizedlist>
                    <listitem>
                        <para>struct <link linkend="namespace_system_1_1_data">System::Data</link></para>
                    </listitem>
                </itemizedlist>
            </para>
            <para>
                <itemizedlist>
                    <listitem>
                        <para>struct <link linkend="namespace_microsoft_1_1_win32">Microsoft::Win32</link></para>
                    </listitem>
                </itemizedlist>
            </para>
            <para>
                <itemizedlist>
                    <listitem>
                        <para>struct <link linkend="namespace_system_1_1_xml_1_1_linq">System::Xml::Linq</link></para>
                    </listitem>
                </itemizedlist>
            </para>
            <para>
                <itemizedlist>
                    <listitem>
                        <para>struct <link linkend="namespace_system_1_1_data_1_1_sql_types">System::Data::SqlTypes</link></para>
                    </listitem>
                </itemizedlist>
            </para>
        </simplesect>
    <simplesect>
        <title>Detailed Description</title>
    <para>Definition in file C:/Users/hinesj/Documents/Visual Studio 2015/Projects/Triggers/Triggers/DatabaseFactory.cs</para>
    </simplesect>
    <literallayout><computeroutput>
1 <emphasis class="keyword">using</emphasis>&#32;<link linkend="namespace_system">System</link>.Data.SqlClient;
2 <emphasis class="keyword">using</emphasis>&#32;<link linkend="namespace_system">System</link>.Data.OleDb;
3 <emphasis class="keyword">using</emphasis>&#32;<link linkend="namespace_system">System</link>.Data;
4 <emphasis class="keyword">using</emphasis>&#32;Microsoft.Win32;
5 <emphasis class="keyword">using</emphasis>&#32;<link linkend="namespace_system">System</link>.IO;
6 <emphasis class="keyword">using</emphasis>&#32;<link linkend="namespace_system">System</link>;
7 <emphasis class="keyword">using</emphasis>&#32;<link linkend="namespace_system">System</link>.Xml;
8 <emphasis class="keyword">using</emphasis>&#32;<link linkend="namespace_system">System</link>.Xml.Linq;
9 <emphasis class="keyword">using</emphasis>&#32;<link linkend="namespace_system">System</link>.Data.SqlTypes;
10 <emphasis class="keyword">using</emphasis>&#32;<link linkend="namespace_triggers">Triggers</link>;
11 <emphasis class="keyword">using</emphasis>&#32;<link linkend="namespace_triggers">Triggers</link>.<link linkend="namespace_triggers_1_1_g_r_cfg3_table_adapters">GRCfg3TableAdapters</link>;
12 
13 <emphasis class="keyword">namespace&#32;</emphasis><link linkend="namespace_configure_one_flag">ConfigureOneFlag</link>
14 {
<link linkend="class_configure_one_flag_1_1_database_factory">18 </link>&#32;&#32;&#32;&#32;<emphasis class="keyword">class&#32;</emphasis><link linkend="class_configure_one_flag_1_1_database_factory">DatabaseFactory</link>&#32;:&#32;<link linkend="class_triggers_1_1ab_database">abDatabase</link>
19 &#32;&#32;&#32;&#32;{
<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">20 </link>&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">static</emphasis>&#32;<link linkend="class_triggers_1_1ab_database">abDatabase</link>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>;
<link linkend="class_configure_one_flag_1_1_database_factory_aa5aa82b5ed9dd8d3610b92ed61a9f2d4_1aa5aa82b5ed9dd8d3610b92ed61a9f2d4">21 </link>&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">static</emphasis>&#32;<emphasis class="keywordtype">string</emphasis>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_aa5aa82b5ed9dd8d3610b92ed61a9f2d4_1aa5aa82b5ed9dd8d3610b92ed61a9f2d4">SQLCommand</link>;
<link linkend="class_configure_one_flag_1_1_database_factory_a97a9d57d4ff36a700cc5233c5fdb9ac5_1a97a9d57d4ff36a700cc5233c5fdb9ac5">22 </link>&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">public</emphasis>&#32;<emphasis class="keyword">static</emphasis>&#32;<emphasis class="keywordtype">string</emphasis>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a97a9d57d4ff36a700cc5233c5fdb9ac5_1a97a9d57d4ff36a700cc5233c5fdb9ac5">connectionString</link>&#32;=&#32;<emphasis class="stringliteral">&quot;&quot;</emphasis>;
<link linkend="class_configure_one_flag_1_1_database_factory_a18b6157c87df47c35c9b7d4b9bcfa30e_1a18b6157c87df47c35c9b7d4b9bcfa30e">23 </link>&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">public</emphasis>&#32;<emphasis class="keyword">static</emphasis>&#32;<emphasis class="keywordtype">string</emphasis>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a18b6157c87df47c35c9b7d4b9bcfa30e_1a18b6157c87df47c35c9b7d4b9bcfa30e">emailaddr</link>&#32;=&#32;<emphasis class="stringliteral">&quot;&quot;</emphasis>;
<link linkend="class_configure_one_flag_1_1_database_factory_a1410899026bc5e03fb6d023a4d5d9618_1a1410899026bc5e03fb6d023a4d5d9618">24 </link>&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">public</emphasis>&#32;<emphasis class="keyword">static</emphasis>&#32;<emphasis class="keywordtype">string</emphasis>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a1410899026bc5e03fb6d023a4d5d9618_1a1410899026bc5e03fb6d023a4d5d9618">emailServer</link>&#32;=&#32;<emphasis class="stringliteral">&quot;&quot;</emphasis>;
<link linkend="class_configure_one_flag_1_1_database_factory_a54d4a975b77e239367db262060b40eed_1a54d4a975b77e239367db262060b40eed">25 </link>&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">public</emphasis>&#32;<emphasis class="keyword">static</emphasis>&#32;<emphasis class="keywordtype">string</emphasis>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a54d4a975b77e239367db262060b40eed_1a54d4a975b77e239367db262060b40eed">emailFrom</link>&#32;=&#32;<emphasis class="stringliteral">&quot;&quot;</emphasis>;
<link linkend="class_configure_one_flag_1_1_database_factory_a055478d8b87ec2968a6319dcd78273f6_1a055478d8b87ec2968a6319dcd78273f6">26 </link>&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">public</emphasis>&#32;<emphasis class="keyword">static</emphasis>&#32;<emphasis class="keywordtype">string</emphasis>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a055478d8b87ec2968a6319dcd78273f6_1a055478d8b87ec2968a6319dcd78273f6">splocation</link>&#32;=&#32;<emphasis class="stringliteral">&quot;&quot;</emphasis>;
<link linkend="class_configure_one_flag_1_1_database_factory_a11d432b379e9e80f1b11ac4884a25ead_1a11d432b379e9e80f1b11ac4884a25ead">27 </link>&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">public</emphasis>&#32;<emphasis class="keyword">static</emphasis>&#32;<emphasis class="keywordtype">string</emphasis>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a11d432b379e9e80f1b11ac4884a25ead_1a11d432b379e9e80f1b11ac4884a25ead">spuname</link>&#32;=&#32;<emphasis class="stringliteral">&quot;&quot;</emphasis>;
<link linkend="class_configure_one_flag_1_1_database_factory_a10149307929348e6d16785e15fc7fbdc_1a10149307929348e6d16785e15fc7fbdc">28 </link>&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">public</emphasis>&#32;<emphasis class="keyword">static</emphasis>&#32;<emphasis class="keywordtype">string</emphasis>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a10149307929348e6d16785e15fc7fbdc_1a10149307929348e6d16785e15fc7fbdc">sppassword</link>&#32;=&#32;<emphasis class="stringliteral">&quot;&quot;</emphasis>;
<link linkend="class_configure_one_flag_1_1_database_factory_aa5daf12fc6167145373805d46ac24f5f_1aa5daf12fc6167145373805d46ac24f5f">29 </link>&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">public</emphasis>&#32;<emphasis class="keyword">static</emphasis>&#32;<emphasis class="keywordtype">string</emphasis>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_aa5daf12fc6167145373805d46ac24f5f_1aa5daf12fc6167145373805d46ac24f5f">decryptedValue</link>&#32;=&#32;<emphasis class="stringliteral">&quot;&quot;</emphasis>;
<link linkend="class_configure_one_flag_1_1_database_factory_a6a42b60bab872801db70540311c4e2bc_1a6a42b60bab872801db70540311c4e2bc">30 </link>&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">public</emphasis>&#32;<emphasis class="keyword">static</emphasis>&#32;<emphasis class="keywordtype">bool</emphasis>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a6a42b60bab872801db70540311c4e2bc_1a6a42b60bab872801db70540311c4e2bc">debugLogging</link>&#32;=&#32;<emphasis class="keyword">false</emphasis>;
<link linkend="class_configure_one_flag_1_1_database_factory_a7ea71eed70f97c7b89407ce8d2c84a27_1a7ea71eed70f97c7b89407ce8d2c84a27">31 </link>&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">public</emphasis>&#32;<emphasis class="keyword">static</emphasis>&#32;<emphasis class="keywordtype">string</emphasis>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a7ea71eed70f97c7b89407ce8d2c84a27_1a7ea71eed70f97c7b89407ce8d2c84a27">dbprotect</link>&#32;=&#32;<emphasis class="stringliteral">&quot;&quot;</emphasis>;
<link linkend="class_configure_one_flag_1_1_database_factory_aafd935142831b5cb6f0e09079aafc8c6_1aafd935142831b5cb6f0e09079aafc8c6">32 </link>&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">public</emphasis>&#32;<emphasis class="keyword">static</emphasis>&#32;<emphasis class="keywordtype">string</emphasis>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_aafd935142831b5cb6f0e09079aafc8c6_1aafd935142831b5cb6f0e09079aafc8c6">ws_uname</link>&#32;=&#32;<emphasis class="stringliteral">&quot;&quot;</emphasis>;
<link linkend="class_configure_one_flag_1_1_database_factory_aa53cf825cde12636ecebfcde3330e911_1aa53cf825cde12636ecebfcde3330e911">33 </link>&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">public</emphasis>&#32;<emphasis class="keyword">static</emphasis>&#32;<emphasis class="keywordtype">string</emphasis>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_aa53cf825cde12636ecebfcde3330e911_1aa53cf825cde12636ecebfcde3330e911">ws_password</link>&#32;=&#32;<emphasis class="stringliteral">&quot;&quot;</emphasis>;
<link linkend="class_configure_one_flag_1_1_database_factory_a6e67b1c4b22a6a59da8850cddbefecdb_1a6e67b1c4b22a6a59da8850cddbefecdb">34 </link>&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">public</emphasis>&#32;<emphasis class="keyword">static</emphasis>&#32;<emphasis class="keywordtype">string</emphasis>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a6e67b1c4b22a6a59da8850cddbefecdb_1a6e67b1c4b22a6a59da8850cddbefecdb">queueControlConnectionString</link>&#32;=&#32;<emphasis class="stringliteral">&quot;&quot;</emphasis>;
<link linkend="class_configure_one_flag_1_1_database_factory_a1285ae98b69e96780f5c745476095e31_1a1285ae98b69e96780f5c745476095e31">35 </link>&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">public</emphasis>&#32;<emphasis class="keyword">static</emphasis>&#32;<emphasis class="keywordtype">string</emphasis>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a1285ae98b69e96780f5c745476095e31_1a1285ae98b69e96780f5c745476095e31">queueControlConnectionStringValueDEV</link>&#32;=&#32;<emphasis class="stringliteral">&quot;&quot;</emphasis>;
<link linkend="class_configure_one_flag_1_1_database_factory_a8bf3215e723938b8bc21b2731c3addf8_1a8bf3215e723938b8bc21b2731c3addf8">36 </link>&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">public</emphasis>&#32;<emphasis class="keyword">static</emphasis>&#32;<emphasis class="keywordtype">string</emphasis>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a8bf3215e723938b8bc21b2731c3addf8_1a8bf3215e723938b8bc21b2731c3addf8">queueControlConnectionStringValuePROD</link>&#32;=&#32;<emphasis class="stringliteral">&quot;&quot;</emphasis>;
<link linkend="class_configure_one_flag_1_1_database_factory_ae1ec057e7696e9c9439a12e6988970d7_1ae1ec057e7696e9c9439a12e6988970d7">37 </link>&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">public</emphasis>&#32;<emphasis class="keywordtype">void</emphasis>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_ae1ec057e7696e9c9439a12e6988970d7_1ae1ec057e7696e9c9439a12e6988970d7">SetConnectionString</link>()
38 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
39 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;RegistryKey&#32;reg&#32;=&#32;Registry.CurrentUser.OpenSubKey(<emphasis class="stringliteral">&quot;SOFTWARE\\Microsoft\\ConfigureOneAssembly\\1.0&quot;</emphasis>,&#32;<emphasis class="keyword">true</emphasis>);
40 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">if</emphasis>&#32;(reg&#32;==&#32;null)
41 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
42 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="comment">//create&#32;keys&#32;if&#32;they&#32;don&apos;t&#32;already&#32;exist&#32;and&#32;set&#32;values</emphasis>
43 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;reg&#32;=&#32;Registry.CurrentUser.CreateSubKey(<emphasis class="stringliteral">&quot;SOFTWARE\\Microsoft\\ConfigureOneAssembly\\1.0&quot;</emphasis>);
44 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordtype">string</emphasis>&#32;dbConnectionData&#32;=&#32;File.ReadAllText(<emphasis class="stringliteral">@&quot;C:\C1\dbconnection.dat&quot;</emphasis>);
45 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordtype">string</emphasis>&#32;dbkey&#32;=&#32;File.ReadAllText(<emphasis class="stringliteral">@&quot;C:\C1\dbkey.dat&quot;</emphasis>);
46 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordtype">string</emphasis>&#32;proddbConnectionData&#32;=&#32;File.ReadAllText(<emphasis class="stringliteral">@&quot;C:\C1\proddbconnection.dat&quot;</emphasis>);
47 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a18b6157c87df47c35c9b7d4b9bcfa30e_1a18b6157c87df47c35c9b7d4b9bcfa30e">emailaddr</link>&#32;=&#32;File.ReadAllText(<emphasis class="stringliteral">@&quot;C:\C1\emailaddr.dat&quot;</emphasis>);
48 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a1410899026bc5e03fb6d023a4d5d9618_1a1410899026bc5e03fb6d023a4d5d9618">emailServer</link>&#32;=&#32;File.ReadAllText(<emphasis class="stringliteral">@&quot;C:\C1\emailserver.dat&quot;</emphasis>);
49 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a54d4a975b77e239367db262060b40eed_1a54d4a975b77e239367db262060b40eed">emailFrom</link>&#32;=&#32;File.ReadAllText(<emphasis class="stringliteral">@&quot;C:\C1\emailFromAddress.dat&quot;</emphasis>);
50 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a055478d8b87ec2968a6319dcd78273f6_1a055478d8b87ec2968a6319dcd78273f6">splocation</link>&#32;=&#32;File.ReadAllText(<emphasis class="stringliteral">@&quot;C:\C1\splocation.dat&quot;</emphasis>);
51 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a11d432b379e9e80f1b11ac4884a25ead_1a11d432b379e9e80f1b11ac4884a25ead">spuname</link>&#32;=&#32;File.ReadAllText(<emphasis class="stringliteral">@&quot;C:\C1\spuname.dat&quot;</emphasis>);
52 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a10149307929348e6d16785e15fc7fbdc_1a10149307929348e6d16785e15fc7fbdc">sppassword</link>&#32;=&#32;File.ReadAllText(<emphasis class="stringliteral">@&quot;C:\C1\sppassword.dat&quot;</emphasis>);
53 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a7ea71eed70f97c7b89407ce8d2c84a27_1a7ea71eed70f97c7b89407ce8d2c84a27">dbprotect</link>&#32;=&#32;File.ReadAllText(<emphasis class="stringliteral">@&quot;C:\C1\protect.dat&quot;</emphasis>);
54 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_aafd935142831b5cb6f0e09079aafc8c6_1aafd935142831b5cb6f0e09079aafc8c6">ws_uname</link>&#32;=&#32;File.ReadAllText(<emphasis class="stringliteral">@&quot;C:\C1\ws_uname.dat&quot;</emphasis>);
55 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_aa53cf825cde12636ecebfcde3330e911_1aa53cf825cde12636ecebfcde3330e911">ws_password</link>&#32;=&#32;File.ReadAllText(<emphasis class="stringliteral">@&quot;C:\C1\ws_password.dat&quot;</emphasis>);
56 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a1285ae98b69e96780f5c745476095e31_1a1285ae98b69e96780f5c745476095e31">queueControlConnectionStringValueDEV</link>&#32;=&#32;File.ReadAllText(<emphasis class="stringliteral">@&quot;C:\C1\queuecontroldev.dat&quot;</emphasis>);
57 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a8bf3215e723938b8bc21b2731c3addf8_1a8bf3215e723938b8bc21b2731c3addf8">queueControlConnectionStringValuePROD</link>&#32;=&#32;File.ReadAllText(<emphasis class="stringliteral">@&quot;C:\C1\queuecontrolprod.dat&quot;</emphasis>);
58 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="comment">//set&#32;registry&#32;values&#32;with&#32;defaults</emphasis>
59 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;reg.SetValue(<emphasis class="stringliteral">&quot;PROD_DB&quot;</emphasis>,&#32;proddbConnectionData);
60 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;reg.SetValue(<emphasis class="stringliteral">&quot;DB&quot;</emphasis>,&#32;dbConnectionData);
61 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;reg.SetValue(<emphasis class="stringliteral">&quot;ENCKEY&quot;</emphasis>,&#32;dbkey);
62 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;reg.SetValue(<emphasis class="stringliteral">&quot;EMAILADDR&quot;</emphasis>,&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a18b6157c87df47c35c9b7d4b9bcfa30e_1a18b6157c87df47c35c9b7d4b9bcfa30e">emailaddr</link>);
63 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;reg.SetValue(<emphasis class="stringliteral">&quot;EMAILSERVER&quot;</emphasis>,&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a1410899026bc5e03fb6d023a4d5d9618_1a1410899026bc5e03fb6d023a4d5d9618">emailServer</link>);
64 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;reg.SetValue(<emphasis class="stringliteral">&quot;EMAILFROM&quot;</emphasis>,&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a54d4a975b77e239367db262060b40eed_1a54d4a975b77e239367db262060b40eed">emailFrom</link>);
65 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;reg.SetValue(<emphasis class="stringliteral">&quot;SPLOCATION&quot;</emphasis>,&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a055478d8b87ec2968a6319dcd78273f6_1a055478d8b87ec2968a6319dcd78273f6">splocation</link>);
66 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;reg.SetValue(<emphasis class="stringliteral">&quot;SPUNAME&quot;</emphasis>,&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a11d432b379e9e80f1b11ac4884a25ead_1a11d432b379e9e80f1b11ac4884a25ead">spuname</link>);
67 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;reg.SetValue(<emphasis class="stringliteral">&quot;SPPASSWORD&quot;</emphasis>,&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a10149307929348e6d16785e15fc7fbdc_1a10149307929348e6d16785e15fc7fbdc">sppassword</link>);
68 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;reg.SetValue(<emphasis class="stringliteral">&quot;DEBUGLOGGING&quot;</emphasis>,&#32;<emphasis class="stringliteral">&quot;NO&quot;</emphasis>);
69 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;reg.SetValue(<emphasis class="stringliteral">&quot;PROTECT&quot;</emphasis>,&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a7ea71eed70f97c7b89407ce8d2c84a27_1a7ea71eed70f97c7b89407ce8d2c84a27">dbprotect</link>);
70 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;reg.SetValue(<emphasis class="stringliteral">&quot;WS_UNAME&quot;</emphasis>,&#32;<link linkend="class_configure_one_flag_1_1_database_factory_aafd935142831b5cb6f0e09079aafc8c6_1aafd935142831b5cb6f0e09079aafc8c6">ws_uname</link>);
71 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;reg.SetValue(<emphasis class="stringliteral">&quot;WS_PASSWORD&quot;</emphasis>,&#32;<link linkend="class_configure_one_flag_1_1_database_factory_aa53cf825cde12636ecebfcde3330e911_1aa53cf825cde12636ecebfcde3330e911">ws_password</link>);
72 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;reg.SetValue(<emphasis class="stringliteral">&quot;QueueControlConnectionDEV&quot;</emphasis>,&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a1285ae98b69e96780f5c745476095e31_1a1285ae98b69e96780f5c745476095e31">queueControlConnectionStringValueDEV</link>);
73 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;reg.SetValue(<emphasis class="stringliteral">&quot;QueueControlConnectionPROD&quot;</emphasis>,&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a8bf3215e723938b8bc21b2731c3addf8_1a8bf3215e723938b8bc21b2731c3addf8">queueControlConnectionStringValuePROD</link>);
74 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
75 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;
76 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="comment">//decrypt&#32;cs</emphasis>
77 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordtype">string</emphasis>&#32;sKey&#32;=&#32;reg.GetValue(<emphasis class="stringliteral">&quot;ENCKEY&quot;</emphasis>).ToString();
78 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a97a9d57d4ff36a700cc5233c5fdb9ac5_1a97a9d57d4ff36a700cc5233c5fdb9ac5">connectionString</link>&#32;=&#32;reg.GetValue(<emphasis class="stringliteral">&quot;DB&quot;</emphasis>).ToString();
79 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a18b6157c87df47c35c9b7d4b9bcfa30e_1a18b6157c87df47c35c9b7d4b9bcfa30e">emailaddr</link>&#32;=&#32;reg.GetValue(<emphasis class="stringliteral">&quot;EMAILADDR&quot;</emphasis>).ToString();
80 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a1410899026bc5e03fb6d023a4d5d9618_1a1410899026bc5e03fb6d023a4d5d9618">emailServer</link>&#32;=&#32;reg.GetValue(<emphasis class="stringliteral">&quot;EMAILSERVER&quot;</emphasis>).ToString();
81 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a54d4a975b77e239367db262060b40eed_1a54d4a975b77e239367db262060b40eed">emailFrom</link>&#32;=&#32;reg.GetValue(<emphasis class="stringliteral">&quot;EMAILFROM&quot;</emphasis>).ToString();
82 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a055478d8b87ec2968a6319dcd78273f6_1a055478d8b87ec2968a6319dcd78273f6">splocation</link>&#32;=&#32;reg.GetValue(<emphasis class="stringliteral">&quot;SPLOCATION&quot;</emphasis>).ToString();
83 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a11d432b379e9e80f1b11ac4884a25ead_1a11d432b379e9e80f1b11ac4884a25ead">spuname</link>&#32;=&#32;reg.GetValue(<emphasis class="stringliteral">&quot;SPUNAME&quot;</emphasis>).ToString();
84 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a10149307929348e6d16785e15fc7fbdc_1a10149307929348e6d16785e15fc7fbdc">sppassword</link>&#32;=&#32;reg.GetValue(<emphasis class="stringliteral">&quot;SPPASSWORD&quot;</emphasis>).ToString();
85 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a97a9d57d4ff36a700cc5233c5fdb9ac5_1a97a9d57d4ff36a700cc5233c5fdb9ac5">connectionString</link>&#32;=&#32;<link linkend="class_configure_one_flag_1_1crypto">crypto</link>.<link linkend="class_configure_one_flag_1_1crypto_a760d19c12b49813c9ec40da0046d509e_1a760d19c12b49813c9ec40da0046d509e">DecryptCS</link>(<link linkend="class_configure_one_flag_1_1_database_factory_a97a9d57d4ff36a700cc5233c5fdb9ac5_1a97a9d57d4ff36a700cc5233c5fdb9ac5">connectionString</link>,&#32;sKey);
86 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a11d432b379e9e80f1b11ac4884a25ead_1a11d432b379e9e80f1b11ac4884a25ead">spuname</link>&#32;=&#32;<link linkend="class_configure_one_flag_1_1crypto">crypto</link>.<link linkend="class_configure_one_flag_1_1crypto_a760d19c12b49813c9ec40da0046d509e_1a760d19c12b49813c9ec40da0046d509e">DecryptCS</link>(<link linkend="class_configure_one_flag_1_1_database_factory_a11d432b379e9e80f1b11ac4884a25ead_1a11d432b379e9e80f1b11ac4884a25ead">spuname</link>,&#32;sKey);
87 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a10149307929348e6d16785e15fc7fbdc_1a10149307929348e6d16785e15fc7fbdc">sppassword</link>&#32;=&#32;<link linkend="class_configure_one_flag_1_1crypto">crypto</link>.<link linkend="class_configure_one_flag_1_1crypto_a760d19c12b49813c9ec40da0046d509e_1a760d19c12b49813c9ec40da0046d509e">DecryptCS</link>(<link linkend="class_configure_one_flag_1_1_database_factory_a10149307929348e6d16785e15fc7fbdc_1a10149307929348e6d16785e15fc7fbdc">sppassword</link>,&#32;sKey);
88 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a7ea71eed70f97c7b89407ce8d2c84a27_1a7ea71eed70f97c7b89407ce8d2c84a27">dbprotect</link>&#32;=&#32;reg.GetValue(<emphasis class="stringliteral">&quot;PROTECT&quot;</emphasis>).ToString();
89 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_aafd935142831b5cb6f0e09079aafc8c6_1aafd935142831b5cb6f0e09079aafc8c6">ws_uname</link>&#32;=&#32;reg.GetValue(<emphasis class="stringliteral">&quot;WS_UNAME&quot;</emphasis>).ToString();
90 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_aa53cf825cde12636ecebfcde3330e911_1aa53cf825cde12636ecebfcde3330e911">ws_password</link>&#32;=&#32;reg.GetValue(<emphasis class="stringliteral">&quot;WS_PASSWORD&quot;</emphasis>).ToString();
91 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a1285ae98b69e96780f5c745476095e31_1a1285ae98b69e96780f5c745476095e31">queueControlConnectionStringValueDEV</link>&#32;=&#32;reg.GetValue(<emphasis class="stringliteral">&quot;QueueControlConnectionDEV&quot;</emphasis>).ToString();
92 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a8bf3215e723938b8bc21b2731c3addf8_1a8bf3215e723938b8bc21b2731c3addf8">queueControlConnectionStringValuePROD</link>&#32;=&#32;reg.GetValue(<emphasis class="stringliteral">&quot;QueueControlConnectionPROD&quot;</emphasis>).ToString();
93 
94 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a6a42b60bab872801db70540311c4e2bc_1a6a42b60bab872801db70540311c4e2bc">debugLogging</link>&#32;=&#32;<emphasis class="keyword">false</emphasis>;
95 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">if</emphasis>&#32;(reg.GetValue(<emphasis class="stringliteral">&quot;DEBUGLOGGING&quot;</emphasis>).ToString()&#32;==&#32;<emphasis class="stringliteral">&quot;YES&quot;</emphasis>)
96 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
97 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a6a42b60bab872801db70540311c4e2bc_1a6a42b60bab872801db70540311c4e2bc">debugLogging</link>&#32;=&#32;<emphasis class="keyword">true</emphasis>;
98 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
99 
100 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a6e67b1c4b22a6a59da8850cddbefecdb_1a6e67b1c4b22a6a59da8850cddbefecdb">queueControlConnectionString</link>&#32;=&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a1285ae98b69e96780f5c745476095e31_1a1285ae98b69e96780f5c745476095e31">queueControlConnectionStringValueDEV</link>;
101 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">if</emphasis>&#32;(reg.GetValue(<emphasis class="stringliteral">&quot;ENVIRONMENT&quot;</emphasis>).ToString()&#32;==&#32;<emphasis class="stringliteral">&quot;PROD&quot;</emphasis>)&#32;{&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a6e67b1c4b22a6a59da8850cddbefecdb_1a6e67b1c4b22a6a59da8850cddbefecdb">queueControlConnectionString</link>&#32;=&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a8bf3215e723938b8bc21b2731c3addf8_1a8bf3215e723938b8bc21b2731c3addf8">queueControlConnectionStringValuePROD</link>;&#32;}
102 
103 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="comment">//if&#32;requested&#32;environment&#32;is&#32;not&#32;dev/test,&#32;change&#32;connectionString&#32;to&#32;prod;&#32;override&#32;to&#32;DEV&#32;if&#32;we&#32;sensed&#32;PROD&#32;but&#32;PROTECT&#32;in&#32;registry&#32;is&#32;YES</emphasis>
104 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">if</emphasis>&#32;(<link linkend="namespace_triggers">Triggers</link>.dbEnvironment&#32;==&#32;<emphasis class="stringliteral">&quot;PROD&quot;</emphasis>&#32;&amp;&amp;&#32;reg.GetValue(<emphasis class="stringliteral">&quot;PROTECT&quot;</emphasis>).ToString()&#32;!=&#32;<emphasis class="stringliteral">&quot;YES&quot;</emphasis>)
105 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
106 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a97a9d57d4ff36a700cc5233c5fdb9ac5_1a97a9d57d4ff36a700cc5233c5fdb9ac5">connectionString</link>&#32;=&#32;reg.GetValue(<emphasis class="stringliteral">&quot;PROD_DB&quot;</emphasis>).ToString();
107 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a6e67b1c4b22a6a59da8850cddbefecdb_1a6e67b1c4b22a6a59da8850cddbefecdb">queueControlConnectionString</link>&#32;=&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a8bf3215e723938b8bc21b2731c3addf8_1a8bf3215e723938b8bc21b2731c3addf8">queueControlConnectionStringValuePROD</link>;&#32;&#32;&#32;<emphasis class="comment">//override&#32;ENVIRONMENT&#32;if&#32;incoming&#32;order&#32;is&#32;production</emphasis>
108 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
109 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;
<link linkend="class_configure_one_flag_1_1_database_factory_a7d20594ae96a13614accd3e7d8d8a04a_1a7d20594ae96a13614accd3e7d8d8a04a">110 </link>&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">public</emphasis>&#32;<emphasis class="keyword">static</emphasis>&#32;<emphasis class="keywordtype">void</emphasis>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a7d20594ae96a13614accd3e7d8d8a04a_1a7d20594ae96a13614accd3e7d8d8a04a">WriteRecordBOM</link>(ref&#32;<link linkend="class_configure_one_flag_1_1z_cfg_b_o_m">zCfgBOM</link>&#32;bom)
111 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
112 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">try</emphasis>
113 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
114 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_triggers_1_1_g_r_cfg3_table_adapters_1_1_g_r___cfg_b_o_m_table_adapter">GR_CfgBOMTableAdapter</link>&#32;tbl&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;<link linkend="class_triggers_1_1_g_r_cfg3_table_adapters_1_1_g_r___cfg_b_o_m_table_adapter">GR_CfgBOMTableAdapter</link>();
115 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tbl.<link linkend="class_triggers_1_1_g_r_cfg3_table_adapters_1_1_g_r___cfg_b_o_m_table_adapter_a66c58871193a551b157785d0b9e4271f_1a66c58871193a551b157785d0b9e4271f">Connection</link>.ConnectionString&#32;=&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a97a9d57d4ff36a700cc5233c5fdb9ac5_1a97a9d57d4ff36a700cc5233c5fdb9ac5">connectionString</link>;
116 
117 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tbl.<link linkend="class_triggers_1_1_g_r_cfg3_table_adapters_1_1_g_r___cfg_b_o_m_table_adapter_a098305f2fad7dc2a70d52ea3d8514a73_1a098305f2fad7dc2a70d52ea3d8514a73">Insert</link>(
118 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;bom.CO_Num,
119 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;bom.CO_Line,
120 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;bom.Sequence,
121 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;bom.Parent,
122 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;bom.Identifier,
123 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;bom.Item,
124 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;bom.Smartpart,
125 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;bom.UnitPrice,
126 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;bom.UnitCost,
127 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;bom.Discount,
128 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;bom.QTY,
129 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;bom.PriorityLevel,
130 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;bom.RecordSequence
131 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;);
132 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
133 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">catch</emphasis>&#32;(Exception&#32;eBOM)
134 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
135 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="namespace_triggers">Triggers</link>.logEvent&#32;=&#32;<emphasis class="stringliteral">&quot;ERROR&#32;WRITING&#32;GR_CFGBOM:&#32;&quot;</emphasis>&#32;+&#32;eBOM.Message;
136 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="namespace_system">System</link>.Diagnostics.EventLog.WriteEntry(<link linkend="namespace_triggers">Triggers</link>.logSource,&#32;<link linkend="namespace_triggers">Triggers</link>.logEvent,&#32;<link linkend="namespace_system">System</link>.Diagnostics.EventLogEntryType.Error,&#32;234);
137 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
138 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<link linkend="class_configure_one_flag_1_1_database_factory_ae84fa2fa2699960542cadbe2053b947d_1ae84fa2fa2699960542cadbe2053b947d">139 </link>&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">public</emphasis>&#32;<emphasis class="keyword">static</emphasis>&#32;<emphasis class="keywordtype">void</emphasis>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_ae84fa2fa2699960542cadbe2053b947d_1ae84fa2fa2699960542cadbe2053b947d">WriteRecordCItem</link>(ref&#32;<link linkend="class_configure_one_flag_1_1z_cfg_item">zCfgItem</link>&#32;item)
140 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
141 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">try</emphasis>
142 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
143 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_triggers_1_1_g_r_cfg3_table_adapters_1_1_g_r___cfg_item_table_adapter">GR_CfgItemTableAdapter</link>&#32;tbl&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;<link linkend="class_triggers_1_1_g_r_cfg3_table_adapters_1_1_g_r___cfg_item_table_adapter">GR_CfgItemTableAdapter</link>();
144 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tbl.<link linkend="class_triggers_1_1_g_r_cfg3_table_adapters_1_1_g_r___cfg_item_table_adapter_a76d01d50e639901a4b2f6387e4797874_1a76d01d50e639901a4b2f6387e4797874">Connection</link>.ConnectionString&#32;=&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a97a9d57d4ff36a700cc5233c5fdb9ac5_1a97a9d57d4ff36a700cc5233c5fdb9ac5">connectionString</link>;
145 
146 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tbl.<link linkend="class_triggers_1_1_g_r_cfg3_table_adapters_1_1_g_r___cfg_item_table_adapter_a9eb1c53f200d9522ebe3ffa996625eef_1a9eb1c53f200d9522ebe3ffa996625eef">Insert</link>(
147 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;item.CO_Num,
148 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;item.CO_Line,
149 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;item.Sequence,
150 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;item.Smartpart,
151 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;item.Item,
152 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;item.Desc,
153 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;item.ItemCost,
154 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;item.ItemPrice,
155 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;item.ItemSellPrice,
156 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;item.ItemWeight,
157 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;item.UnitOfMeasure,
158 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;item.PriorityLevel,
159 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;item.IM_VAR1,
160 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;item.IM_VAR2,
161 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;item.IM_VAR3,
162 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;item.IM_VAR4,
163 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;item.IM_VAR5
164 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;);
165 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
166 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">catch</emphasis>&#32;(Exception&#32;eCI)
167 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
168 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="namespace_triggers">Triggers</link>.logEvent&#32;=&#32;<emphasis class="stringliteral">&quot;ERROR&#32;WRITING&#32;GR_CFGITEM:&#32;&quot;</emphasis>&#32;+&#32;eCI.Message;
169 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="namespace_system">System</link>.Diagnostics.EventLog.WriteEntry(<link linkend="namespace_triggers">Triggers</link>.logSource,&#32;<link linkend="namespace_triggers">Triggers</link>.logEvent,&#32;<link linkend="namespace_system">System</link>.Diagnostics.EventLogEntryType.Error,&#32;234);
170 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
171 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<link linkend="class_configure_one_flag_1_1_database_factory_aeab9b81fff5fdf32493ce1f2c2c0082b_1aeab9b81fff5fdf32493ce1f2c2c0082b">172 </link>&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">public</emphasis>&#32;<emphasis class="keyword">static</emphasis>&#32;<emphasis class="keywordtype">void</emphasis>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_aeab9b81fff5fdf32493ce1f2c2c0082b_1aeab9b81fff5fdf32493ce1f2c2c0082b">WriteRecordCfg</link>(ref&#32;<link linkend="class_configure_one_flag_1_1z_cfg_parm_val">zCfgParmVal</link>&#32;cfg)
173 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
174 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">try</emphasis>
175 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
176 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_triggers_1_1_g_r_cfg3_table_adapters_1_1_g_r___cfg_parm_val_table_adapter">GR_CfgParmValTableAdapter</link>&#32;tbl&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;<link linkend="class_triggers_1_1_g_r_cfg3_table_adapters_1_1_g_r___cfg_parm_val_table_adapter">GR_CfgParmValTableAdapter</link>();
177 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tbl.<link linkend="class_triggers_1_1_g_r_cfg3_table_adapters_1_1_g_r___cfg_parm_val_table_adapter_ae44453e7a25414f150bf49b59340badc_1ae44453e7a25414f150bf49b59340badc">Connection</link>.ConnectionString&#32;=&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a97a9d57d4ff36a700cc5233c5fdb9ac5_1a97a9d57d4ff36a700cc5233c5fdb9ac5">connectionString</link>;
178 
179 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tbl.<link linkend="class_triggers_1_1_g_r_cfg3_table_adapters_1_1_g_r___cfg_parm_val_table_adapter_a6fc2904bbf764ee1f2f077bec2764933_1a6fc2904bbf764ee1f2f077bec2764933">Insert</link>(
180 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;cfg.CO_Num,
181 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;cfg.CO_Line,
182 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;cfg.CName,
183 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;cfg.CValue,
184 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;cfg.CType,
185 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;cfg.CLabel,
186 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;cfg.PriorityLevel
187 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;);
188 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
189 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">catch</emphasis>&#32;(Exception&#32;eCFG)
190 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
191 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="namespace_triggers">Triggers</link>.logEvent&#32;=&#32;<emphasis class="stringliteral">&quot;ERROR&#32;WRITING&#32;GR_CFGPARMVAL:&#32;&quot;</emphasis>&#32;+&#32;eCFG.Message;
192 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="namespace_system">System</link>.Diagnostics.EventLog.WriteEntry(<link linkend="namespace_triggers">Triggers</link>.logSource,&#32;<link linkend="namespace_triggers">Triggers</link>.logEvent,&#32;<link linkend="namespace_system">System</link>.Diagnostics.EventLogEntryType.Error,&#32;234);
193 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
194 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<link linkend="class_configure_one_flag_1_1_database_factory_a7e40f3f0a85ffe44b8c2a3197e6d8925_1a7e40f3f0a85ffe44b8c2a3197e6d8925">195 </link>&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">public</emphasis>&#32;<emphasis class="keyword">static</emphasis>&#32;<emphasis class="keywordtype">void</emphasis>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a7e40f3f0a85ffe44b8c2a3197e6d8925_1a7e40f3f0a85ffe44b8c2a3197e6d8925">WriteRecordCOItem</link>(ref&#32;<link linkend="class_configure_one_flag_1_1z_cfg_c_oitem">zCfgCOitem</link>&#32;coitem)
196 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
197 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">try</emphasis>
198 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
199 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_triggers_1_1_g_r_cfg3_table_adapters_1_1_g_r___cfg_coitem_table_adapter">GR_CfgCoitemTableAdapter</link>&#32;tbl&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;<link linkend="class_triggers_1_1_g_r_cfg3_table_adapters_1_1_g_r___cfg_coitem_table_adapter">GR_CfgCoitemTableAdapter</link>();
200 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tbl.<link linkend="class_triggers_1_1_g_r_cfg3_table_adapters_1_1_g_r___cfg_coitem_table_adapter_a35fa2ba62904255645f3dd83dbef9e7e_1a35fa2ba62904255645f3dd83dbef9e7e">Connection</link>.ConnectionString&#32;=&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a97a9d57d4ff36a700cc5233c5fdb9ac5_1a97a9d57d4ff36a700cc5233c5fdb9ac5">connectionString</link>;
201 
202 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tbl.<link linkend="class_triggers_1_1_g_r_cfg3_table_adapters_1_1_g_r___cfg_coitem_table_adapter_a6cc6640b150a142ee52f74701a6fbeb3_1a6cc6640b150a142ee52f74701a6fbeb3">Insert</link>(
203 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;coitem.CO_Num,
204 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;coitem.CO_Line,
205 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;coitem.Serial,
206 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;coitem.Item,
207 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;coitem.Smartpart,
208 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;coitem.Desc,
209 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;coitem.UnitPrice,
210 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;coitem.UnitCost,
211 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;coitem.Discount,
212 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;coitem.QTY,
213 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;coitem.PriorityLevel,
214 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;coitem.DueDate,
215 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;coitem.ConfigType,
216 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;coitem.CustPO,
217 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;coitem.OrderLineNotes
218 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;);
219 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
220 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">catch</emphasis>&#32;(Exception&#32;coitemx)
221 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
222 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="namespace_triggers">Triggers</link>.logEvent&#32;=&#32;<emphasis class="stringliteral">&quot;ERROR&#32;WRITING&#32;GR_CFGCOItem:&#32;&quot;</emphasis>&#32;+&#32;coitemx.Message;
223 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="namespace_system">System</link>.Diagnostics.EventLog.WriteEntry(<link linkend="namespace_triggers">Triggers</link>.logSource,&#32;<link linkend="namespace_triggers">Triggers</link>.logEvent,&#32;<link linkend="namespace_system">System</link>.Diagnostics.EventLogEntryType.Error,&#32;234);
224 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
225 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<link linkend="class_configure_one_flag_1_1_database_factory_a628dded3ecd9efab9c21a01a864dc518_1a628dded3ecd9efab9c21a01a864dc518">226 </link>&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">public</emphasis>&#32;<emphasis class="keyword">static</emphasis>&#32;<emphasis class="keywordtype">void</emphasis>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a628dded3ecd9efab9c21a01a864dc518_1a628dded3ecd9efab9c21a01a864dc518">WriteRecordCO</link>(ref&#32;<link linkend="class_configure_one_flag_1_1z_cfg_c_o">zCfgCO</link>&#32;co)
227 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
228 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">try</emphasis>
229 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
230 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_triggers_1_1_g_r_cfg3_table_adapters_1_1_g_r___cfg_c_o_table_adapter">GR_CfgCOTableAdapter</link>&#32;tbl&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;<link linkend="class_triggers_1_1_g_r_cfg3_table_adapters_1_1_g_r___cfg_c_o_table_adapter">GR_CfgCOTableAdapter</link>();
231 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tbl.<link linkend="class_triggers_1_1_g_r_cfg3_table_adapters_1_1_g_r___cfg_c_o_table_adapter_a5bb0cbbe5b637dbc7d092576f8cc595f_1a5bb0cbbe5b637dbc7d092576f8cc595f">Connection</link>.ConnectionString&#32;=&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a97a9d57d4ff36a700cc5233c5fdb9ac5_1a97a9d57d4ff36a700cc5233c5fdb9ac5">connectionString</link>;
232 
233 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tbl.<link linkend="class_triggers_1_1_g_r_cfg3_table_adapters_1_1_g_r___cfg_c_o_table_adapter_aa217e7394161095dfcb281cd4fb3af99_1aa217e7394161095dfcb281cd4fb3af99">Insert</link>(
234 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.Identifier,
235 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.CO_Num,
236 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.CORefNum,
237 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.CustName,
238 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.CustRefNum,
239 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.AccountNum,
240 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.ErpReferenceNum,
241 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.Project,
242 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.PaymentTerms,
243 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.ShipVia,
244 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.ShippingTerms,
245 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.BillToContactName,
246 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.BillToAddressLine1,
247 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.BillToAddressLine2,
248 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.BillToAddressLine3,
249 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.BillToCity,
250 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.BillToState,
251 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.BillToCountry,
252 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.BillToPostalCode,
253 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.BillToPhoneNumber,
254 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.BillToFaxNumber,
255 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.BillToEmailAddress,
256 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.BillToRefNum,
257 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.ShipToContactName,
258 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.ShipToAddressLine1,
259 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.ShipToAddressLine2,
260 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.ShipToAddressLine3,
261 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.ShipToCity,
262 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.ShipToState,
263 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.ShipToCountry,
264 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.ShipToPostalCode,
265 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.ShipToPhoneNumber,
266 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.ShipToFaxNumber,
267 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.ShipToEmailAddress,
268 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.ShipToRefNum,
269 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.PriorityLevel,
270 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;null,
271 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;null,
272 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.DueDate,
273 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.CustPO,
274 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.DropShipAddress4,
275 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.FreightTerms,
276 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.FreightAcct,
277 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.QuoteNbr,
278 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.WebUserName,
279 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.WebOrderDate,
280 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.DropShipAddress1,
281 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.DropShipAddress2,
282 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.DropShipAddress3,
283 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.DropShipAddress4,
284 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.DropShipCity,
285 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.DropShipState,
286 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.DropShipZip,
287 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.DropShipName,
288 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.DropShipContact,
289 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.DropShipCountry,
290 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.DropShipPhone,
291 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.DropShipEmail,
292 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.RequestDate,
293 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.DestinationCountry,
294 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.OrderHeaderNotes,
295 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.EndUser,
296 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;co.Engineer);
297 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
298 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">catch</emphasis>&#32;(Exception&#32;coex)
299 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
300 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="namespace_triggers">Triggers</link>.logEvent&#32;=&#32;<emphasis class="stringliteral">&quot;ERROR&#32;WRITING&#32;GR_CFGCO:&#32;&quot;</emphasis>&#32;+&#32;coex.Message;
301 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="namespace_system">System</link>.Diagnostics.EventLog.WriteEntry(<link linkend="namespace_triggers">Triggers</link>.logSource,&#32;<link linkend="namespace_triggers">Triggers</link>.logEvent,&#32;<link linkend="namespace_system">System</link>.Diagnostics.EventLogEntryType.Error,&#32;234);
302 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
303 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<link linkend="class_configure_one_flag_1_1_database_factory_a0b616fafdb354df961cb94c784943bc4_1a0b616fafdb354df961cb94c784943bc4">304 </link>&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">public</emphasis>&#32;<emphasis class="keyword">static</emphasis>&#32;<emphasis class="keywordtype">void</emphasis>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a0b616fafdb354df961cb94c784943bc4_1a0b616fafdb354df961cb94c784943bc4">WriteRecordCfgRoute</link>(ref&#32;<link linkend="class_configure_one_flag_1_1z_cfg_route">zCfgRoute</link>&#32;route)
305 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
306 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">try</emphasis>
307 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
308 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_triggers_1_1_g_r_cfg3_table_adapters_1_1_g_r___cfg_route_b_o_m_table_adapter">GR_CfgRouteBOMTableAdapter</link>&#32;tbl&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;<link linkend="class_triggers_1_1_g_r_cfg3_table_adapters_1_1_g_r___cfg_route_b_o_m_table_adapter">GR_CfgRouteBOMTableAdapter</link>();
309 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tbl.<link linkend="class_triggers_1_1_g_r_cfg3_table_adapters_1_1_g_r___cfg_route_b_o_m_table_adapter_a726a56c0ee30cbfc177c8443a6357c33_1a726a56c0ee30cbfc177c8443a6357c33">Connection</link>.ConnectionString&#32;=&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a97a9d57d4ff36a700cc5233c5fdb9ac5_1a97a9d57d4ff36a700cc5233c5fdb9ac5">connectionString</link>;
310 
311 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tbl.<link linkend="class_triggers_1_1_g_r_cfg3_table_adapters_1_1_g_r___cfg_route_b_o_m_table_adapter_ab97d5b40bcdb4d149696bf65db97093b_1ab97d5b40bcdb4d149696bf65db97093b">Insert</link>(
312 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;route.CO_Num,
313 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;route.CO_Line,
314 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;route.Seq,
315 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;route.Type,
316 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;route.BOM_ID,
317 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;route.ItemNum,
318 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;route.SmartpartNum,
319 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;route.OPERATION,
320 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;route.WC,
321 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;route.Description,
322 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;(decimal?)route.Labor_Hours,
323 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;(decimal?)route.Setup_Hours,
324 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;(decimal?)route.Labor_Rate,
325 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;route.Notes,
326 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;route.Machine_Name,
327 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;(decimal?)route.Run_Time,
328 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;route.MatlItemNum,
329 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;route.MatlSmartpartNum,
330 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;route.MatlQty
331 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;);
332 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
333 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">catch</emphasis>&#32;(Exception&#32;RBError)
334 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
335 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="namespace_triggers">Triggers</link>.logEvent&#32;=&#32;<emphasis class="stringliteral">&quot;ERROR&#32;WRITING&#32;GR_CfgRouteBOM:&#32;&quot;</emphasis>&#32;+&#32;RBError.Message;
336 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="namespace_system">System</link>.Diagnostics.EventLog.WriteEntry(<link linkend="namespace_triggers">Triggers</link>.logSource,&#32;<link linkend="namespace_triggers">Triggers</link>.logEvent,&#32;<link linkend="namespace_system">System</link>.Diagnostics.EventLogEntryType.Error,&#32;234);
337 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
338 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<link linkend="class_configure_one_flag_1_1_database_factory_acd9475f1b9763dfab5896656f96789a0_1acd9475f1b9763dfab5896656f96789a0">339 </link>&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">public</emphasis>&#32;<emphasis class="keyword">static</emphasis>&#32;<emphasis class="keywordtype">void</emphasis>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_acd9475f1b9763dfab5896656f96789a0_1acd9475f1b9763dfab5896656f96789a0">ResequenceBOM</link>(<emphasis class="keywordtype">string</emphasis>&#32;orderNumber,&#32;<emphasis class="keywordtype">int</emphasis>&#32;orderLine)
340 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
341 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">try</emphasis>
342 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
343 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">using</emphasis>&#32;(<link linkend="class_triggers_1_1_db_connection">DbConnection</link>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;<link linkend="class_triggers_1_1_db_connection">DbConnection</link>())
344 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
345 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;SqlCommand(<emphasis class="stringliteral">&quot;GR_Cfg_ResequenceBOMSp&quot;</emphasis>,&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>);
346 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.CommandType&#32;=&#32;CommandType.StoredProcedure;
347 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.Parameters.AddWithValue(<emphasis class="stringliteral">&quot;@OrderNumber&quot;</emphasis>,&#32;orderNumber);
348 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.Parameters.AddWithValue(<emphasis class="stringliteral">&quot;@OrderLine&quot;</emphasis>,&#32;orderLine);
349 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.CommandTimeout&#32;=&#32;120000;
350 
351 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>.Open();
352 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.ExecuteNonQuery();
353 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>.Close();
354 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
355 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
356 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">catch</emphasis>&#32;(Exception&#32;bomreseq)
357 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
358 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordtype">string</emphasis>&#32;logEvent&#32;=&#32;<emphasis class="stringliteral">&quot;An&#32;error&#32;resequence-BOM&#32;occurred:&#32;&quot;</emphasis>&#32;+&#32;bomreseq.Message;
359 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="namespace_system">System</link>.Diagnostics.EventLog.WriteEntry(<link linkend="namespace_triggers">Triggers</link>.logSource,&#32;logEvent,&#32;<link linkend="namespace_system">System</link>.Diagnostics.EventLogEntryType.Warning,&#32;234);
360 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
361 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<link linkend="class_configure_one_flag_1_1_database_factory_ae4aeef8c1f02cf82b17a4e1c2ca0ffed_1ae4aeef8c1f02cf82b17a4e1c2ca0ffed">362 </link>&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">public</emphasis>&#32;<emphasis class="keyword">static</emphasis>&#32;<emphasis class="keywordtype">void</emphasis>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_ae4aeef8c1f02cf82b17a4e1c2ca0ffed_1ae4aeef8c1f02cf82b17a4e1c2ca0ffed">CfgImport</link>(<emphasis class="keywordtype">string</emphasis>&#32;orderNumber)
363 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
364 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="comment">//call&#32;SP&#32;to&#32;import&#32;data&#32;into&#32;Syteline</emphasis>
365 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordtype">int</emphasis>&#32;CreateOrder&#32;=&#32;1;
366 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">using</emphasis>&#32;(<link linkend="class_triggers_1_1_db_connection">DbConnection</link>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;<link linkend="class_triggers_1_1_db_connection">DbConnection</link>())
367 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
368 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;SqlCommand(<emphasis class="stringliteral">&quot;GR_CfgImportSp&quot;</emphasis>,&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>);
369 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.CommandType&#32;=&#32;CommandType.StoredProcedure;
370 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.Parameters.AddWithValue(<emphasis class="stringliteral">&quot;@pStartingOrderNum&quot;</emphasis>,&#32;orderNumber);
371 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.Parameters.AddWithValue(<emphasis class="stringliteral">&quot;@pEndingOrderNum&quot;</emphasis>,&#32;orderNumber);
372 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.Parameters.AddWithValue(<emphasis class="stringliteral">&quot;@pCreateOrder&quot;</emphasis>,&#32;CreateOrder);
373 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.CommandTimeout&#32;=&#32;120000;
374 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>.Open();
375 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">try</emphasis>
376 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
377 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.ExecuteNonQuery();
378 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
379 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">catch</emphasis>&#32;(Exception&#32;spI)
380 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
381 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="comment">//A&#32;timeout&#32;has&#32;likely&#32;occurred;&#32;try&#32;again</emphasis>
382 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordtype">string</emphasis>&#32;logEvent&#32;=&#32;<emphasis class="stringliteral">&quot;An&#32;error&#32;executing&#32;GR_CfgImportSp&#32;has&#32;occurred:&#32;&quot;</emphasis>&#32;+&#32;spI.Message&#32;+&#32;<emphasis class="stringliteral">&quot;&#32;-&gt;&#32;Retrying...&quot;</emphasis>;
383 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="namespace_system">System</link>.Diagnostics.EventLog.WriteEntry(<link linkend="namespace_triggers">Triggers</link>.logSource,&#32;logEvent,&#32;<link linkend="namespace_system">System</link>.Diagnostics.EventLogEntryType.Warning,&#32;234);
384 
385 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>.Close();
386 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>.Open();
387 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.ExecuteNonQuery();
388 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
389 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
390 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<link linkend="class_configure_one_flag_1_1_database_factory_a1cba3b4ca48fe4e537bdc28925a61719_1a1cba3b4ca48fe4e537bdc28925a61719">391 </link>&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">public</emphasis>&#32;<emphasis class="keyword">static</emphasis>&#32;<emphasis class="keywordtype">void</emphasis>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a1cba3b4ca48fe4e537bdc28925a61719_1a1cba3b4ca48fe4e537bdc28925a61719">CleanupOrder</link>(<emphasis class="keywordtype">string</emphasis>&#32;orderNum)
392 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
393 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">using</emphasis>&#32;(<link linkend="class_triggers_1_1_db_connection">DbConnection</link>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;<link linkend="class_triggers_1_1_db_connection">DbConnection</link>())
394 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
395 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;SqlCommand(<emphasis class="stringliteral">&quot;GR_CfgOrderCleanupSp&quot;</emphasis>,&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>);
396 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.CommandType&#32;=&#32;CommandType.StoredProcedure;
397 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.Parameters.AddWithValue(<emphasis class="stringliteral">&quot;@OrderNumber&quot;</emphasis>,&#32;orderNum);
398 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.CommandTimeout&#32;=&#32;120000;
399 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>.Open();
400 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">try</emphasis>
401 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
402 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.ExecuteNonQuery();
403 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
404 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">catch</emphasis>&#32;(Exception&#32;spI)
405 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
406 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="comment">//A&#32;timeout&#32;has&#32;likely&#32;occurred</emphasis>
407 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordtype">string</emphasis>&#32;logEvent&#32;=&#32;<emphasis class="stringliteral">&quot;An&#32;error&#32;executing&#32;GR_CfgOrderCleanupSp&#32;has&#32;occurred:&#32;&quot;</emphasis>&#32;+&#32;spI.Message;
408 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="namespace_system">System</link>.Diagnostics.EventLog.WriteEntry(<link linkend="namespace_triggers">Triggers</link>.logSource,&#32;logEvent,&#32;<link linkend="namespace_system">System</link>.Diagnostics.EventLogEntryType.Warning,&#32;234);
409 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
410 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
411 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<link linkend="class_configure_one_flag_1_1_database_factory_a59987be56acf3f8cbf7681d6b4866e81_1a59987be56acf3f8cbf7681d6b4866e81">412 </link>&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">public</emphasis>&#32;<emphasis class="keyword">static</emphasis>&#32;<emphasis class="keywordtype">void</emphasis>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a59987be56acf3f8cbf7681d6b4866e81_1a59987be56acf3f8cbf7681d6b4866e81">WriteAuditRecord</link>(<emphasis class="keywordtype">string</emphasis>&#32;auditMessageL,&#32;<emphasis class="keywordtype">string</emphasis>&#32;orderNum,&#32;<emphasis class="keywordtype">int</emphasis>&#32;orderLine,&#32;<emphasis class="keywordtype">string</emphasis>&#32;auditEvent)
413 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
414 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">try</emphasis>
415 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
416 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">using</emphasis>&#32;(<link linkend="class_triggers_1_1_db_connection">DbConnection</link>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;<link linkend="class_triggers_1_1_db_connection">DbConnection</link>())
417 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
418 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_aa5aa82b5ed9dd8d3610b92ed61a9f2d4_1aa5aa82b5ed9dd8d3610b92ed61a9f2d4">SQLCommand</link>&#32;=&#32;<emphasis class="stringliteral">&quot;Insert&#32;Into&#32;GR_Cfg_Audit&#32;(order_num,order_line_num,auditEvent,auditMessageL)&#32;values&#32;(@orderNum,&#32;@orderLine,&#32;@auditEvent,&#32;@auditMessageL)&quot;</emphasis>;
419 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;SqlCommand(<link linkend="class_configure_one_flag_1_1_database_factory_aa5aa82b5ed9dd8d3610b92ed61a9f2d4_1aa5aa82b5ed9dd8d3610b92ed61a9f2d4">SQLCommand</link>,&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>);
420 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.CommandTimeout&#32;=&#32;120000;
421 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;SqlParameter&#32;order_num&#32;=&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.Parameters.AddWithValue(<emphasis class="stringliteral">&quot;@orderNum&quot;</emphasis>,&#32;orderNum);
422 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;SqlParameter&#32;order_line&#32;=&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.Parameters.AddWithValue(<emphasis class="stringliteral">&quot;@orderLine&quot;</emphasis>,&#32;orderLine);
423 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;SqlParameter&#32;audit_event&#32;=&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.Parameters.AddWithValue(<emphasis class="stringliteral">&quot;@auditEvent&quot;</emphasis>,&#32;auditEvent);
424 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;SqlParameter&#32;audit_message&#32;=&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.Parameters.AddWithValue(<emphasis class="stringliteral">&quot;@auditMessageL&quot;</emphasis>,&#32;auditMessageL);
425 
426 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>.Open();
427 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.ExecuteNonQuery();
428 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
429 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
430 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">catch</emphasis>&#32;(Exception&#32;auditex)
431 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
432 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordtype">string</emphasis>&#32;logEvent&#32;=&#32;<emphasis class="stringliteral">&quot;Ignoring&#32;Audit&#32;message&#32;error:&#32;&quot;</emphasis>&#32;+&#32;auditex.Message;
433 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="namespace_system">System</link>.Diagnostics.EventLog.WriteEntry(<link linkend="namespace_triggers">Triggers</link>.logSource,&#32;logEvent,&#32;<link linkend="namespace_system">System</link>.Diagnostics.EventLogEntryType.Warning,&#32;234);
434 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
435 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<link linkend="class_configure_one_flag_1_1_database_factory_a64f0488a247638877def2f773331d184_1a64f0488a247638877def2f773331d184">436 </link>&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">public</emphasis>&#32;<emphasis class="keyword">static</emphasis>&#32;<emphasis class="keywordtype">string</emphasis>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a64f0488a247638877def2f773331d184_1a64f0488a247638877def2f773331d184">RetrieveSLCO</link>(<emphasis class="keywordtype">string</emphasis>&#32;orderNum)
437 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
438 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordtype">string</emphasis>&#32;SLOrderNumber&#32;=&#32;<emphasis class="stringliteral">&quot;&quot;</emphasis>;
439 
440 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">using</emphasis>&#32;(<link linkend="class_triggers_1_1_db_connection">DbConnection</link>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;<link linkend="class_triggers_1_1_db_connection">DbConnection</link>())
441 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
442 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">try</emphasis>
443 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
444 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_aa5aa82b5ed9dd8d3610b92ed61a9f2d4_1aa5aa82b5ed9dd8d3610b92ed61a9f2d4">SQLCommand</link>&#32;=&#32;<emphasis class="stringliteral">&quot;Select&#32;TOP&#32;1&#32;co_num&#32;as&#32;SLCO&#32;From&#32;GR_CfgCO&#32;c&#32;with(nolock)&#32;Where&#32;c.order_num&#32;=&#32;@order_num&quot;</emphasis>;
445 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;SqlCommand(<link linkend="class_configure_one_flag_1_1_database_factory_aa5aa82b5ed9dd8d3610b92ed61a9f2d4_1aa5aa82b5ed9dd8d3610b92ed61a9f2d4">SQLCommand</link>,&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>);
446 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.CommandTimeout&#32;=&#32;120000;
447 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;SqlParameter&#32;order_num&#32;=&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.Parameters.Add(<emphasis class="stringliteral">&quot;@order_num&quot;</emphasis>,&#32;SqlDbType.NVarChar,&#32;15);
448 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;order_num.Value&#32;=&#32;orderNum;
449 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>.Open();
450 
451 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">using</emphasis>&#32;(SqlDataReader&#32;reader&#32;=&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.ExecuteReader())
452 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
453 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">if</emphasis>&#32;(reader.HasRows)
454 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
455 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">if</emphasis>&#32;(reader.Read())
456 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
457 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;SLOrderNumber&#32;=&#32;reader[<emphasis class="stringliteral">&quot;SLCO&quot;</emphasis>].ToString();
458 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
459 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
460 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;reader.Close();
461 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
462 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
463 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">catch</emphasis>&#32;(Exception&#32;rCOex)
464 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
465 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="namespace_triggers">Triggers</link>.logEvent&#32;=&#32;<emphasis class="stringliteral">&quot;ERROR&#32;RETRIEVING&#32;SLCO:&#32;&quot;</emphasis>&#32;+&#32;rCOex.Message;
466 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="namespace_system">System</link>.Diagnostics.EventLog.WriteEntry(<link linkend="namespace_triggers">Triggers</link>.logSource,&#32;<link linkend="namespace_triggers">Triggers</link>.logEvent,&#32;<link linkend="namespace_system">System</link>.Diagnostics.EventLogEntryType.Error,&#32;234);
467 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
468 
469 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>.Close();
470 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">return</emphasis>&#32;SLOrderNumber;
471 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
472 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<link linkend="class_configure_one_flag_1_1_database_factory_a0b3faff4145a97817540e0ab92ae9101_1a0b3faff4145a97817540e0ab92ae9101">473 </link>&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">public</emphasis>&#32;<emphasis class="keyword">static</emphasis>&#32;<emphasis class="keywordtype">string</emphasis>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a0b3faff4145a97817540e0ab92ae9101_1a0b3faff4145a97817540e0ab92ae9101">RetrieveISOCountry</link>(<emphasis class="keywordtype">string</emphasis>&#32;ISOCode)
474 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
475 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordtype">string</emphasis>&#32;ISOCountry&#32;=&#32;<emphasis class="stringliteral">&quot;&quot;</emphasis>;
476 
477 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_aa5aa82b5ed9dd8d3610b92ed61a9f2d4_1aa5aa82b5ed9dd8d3610b92ed61a9f2d4">SQLCommand</link>&#32;=&#32;<emphasis class="stringliteral">&quot;Select&#32;IsNULL(country,&#32;&apos;&#32;&apos;)&#32;as&#32;country&#32;from&#32;country&#32;with&#32;(nolock)&#32;Where&#32;iso_country_code&#32;=&#32;@isoCode&quot;</emphasis>;
478 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">using</emphasis>&#32;(<link linkend="class_triggers_1_1_db_connection">DbConnection</link>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;<link linkend="class_triggers_1_1_db_connection">DbConnection</link>())
479 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
480 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;SqlCommand(<link linkend="class_configure_one_flag_1_1_database_factory_aa5aa82b5ed9dd8d3610b92ed61a9f2d4_1aa5aa82b5ed9dd8d3610b92ed61a9f2d4">SQLCommand</link>,&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>);
481 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.CommandTimeout&#32;=&#32;120000;
482 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;SqlParameter&#32;iso_code&#32;=&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.Parameters.AddWithValue(<emphasis class="stringliteral">&quot;@isoCode&quot;</emphasis>,&#32;ISOCode);
483 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>.Open();
484 
485 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">using</emphasis>&#32;(SqlDataReader&#32;reader&#32;=&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.ExecuteReader())
486 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
487 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">if</emphasis>&#32;(reader.HasRows)
488 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
489 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">if</emphasis>&#32;(reader.Read())
490 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
491 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ISOCountry&#32;=&#32;reader[<emphasis class="stringliteral">&quot;country&quot;</emphasis>].ToString();
492 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
493 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
494 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;reader.Close();
495 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
496 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>.Close();
497 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
498 
499 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">return</emphasis>&#32;ISOCountry;
500 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<link linkend="class_configure_one_flag_1_1_database_factory_a58f013f5a91fe754f457a1e3ad26ebea_1a58f013f5a91fe754f457a1e3ad26ebea">501 </link>&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">public</emphasis>&#32;<emphasis class="keyword">static</emphasis>&#32;<emphasis class="keywordtype">void</emphasis>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a58f013f5a91fe754f457a1e3ad26ebea_1a58f013f5a91fe754f457a1e3ad26ebea">InsertDocumentRecord</link>(XmlDocument&#32;xml,&#32;<emphasis class="keywordtype">string</emphasis>&#32;orderNum,&#32;<emphasis class="keywordtype">string</emphasis>&#32;environment,&#32;<emphasis class="keywordtype">string</emphasis>&#32;site,&#32;<emphasis class="keywordtype">string</emphasis>&#32;SLorderNumber)
502 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
503 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordtype">string</emphasis>&#32;maintConnectionString&#32;=&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a97a9d57d4ff36a700cc5233c5fdb9ac5_1a97a9d57d4ff36a700cc5233c5fdb9ac5">connectionString</link>;
504 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a97a9d57d4ff36a700cc5233c5fdb9ac5_1a97a9d57d4ff36a700cc5233c5fdb9ac5">connectionString</link>&#32;=&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a6e67b1c4b22a6a59da8850cddbefecdb_1a6e67b1c4b22a6a59da8850cddbefecdb">queueControlConnectionString</link>;
505 
506 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="comment">//database&#32;=&#32;new&#32;DbConnection();</emphasis>
507 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="comment">//database.Connection.Close();</emphasis>
508 
510 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="comment">//if&#32;(database.Connection.State&#32;==&#32;ConnectionState.Open)</emphasis>
511 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="comment">//{</emphasis>
512 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="comment">//&#32;&#32;&#32;&#32;System.Threading.Thread.Sleep(1000);</emphasis>
513 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="comment">//}</emphasis>
514 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;
515 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_aa5aa82b5ed9dd8d3610b92ed61a9f2d4_1aa5aa82b5ed9dd8d3610b92ed61a9f2d4">SQLCommand</link>&#32;=&#32;<emphasis class="stringliteral">&quot;Insert&#32;Into&#32;GR_Cfg_DocumentQueue(order_num,&#32;environment,&#32;site,&#32;SLOrderNumber,&#32;orderXML)&#32;values(@orderNum,&#32;@environment,&#32;@site,&#32;@SLorderNumber,&#32;@xmldata)&quot;</emphasis>;
516 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">using</emphasis>&#32;(<link linkend="class_triggers_1_1_db_connection">DbConnection</link>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;<link linkend="class_triggers_1_1_db_connection">DbConnection</link>())
517 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
518 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;SqlCommand(<link linkend="class_configure_one_flag_1_1_database_factory_aa5aa82b5ed9dd8d3610b92ed61a9f2d4_1aa5aa82b5ed9dd8d3610b92ed61a9f2d4">SQLCommand</link>,&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>);
519 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.Parameters.AddWithValue(<emphasis class="stringliteral">&quot;@orderNum&quot;</emphasis>,&#32;orderNum);
520 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.Parameters.AddWithValue(<emphasis class="stringliteral">&quot;@environment&quot;</emphasis>,&#32;environment);
521 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.Parameters.AddWithValue(<emphasis class="stringliteral">&quot;@site&quot;</emphasis>,&#32;site);
522 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.Parameters.AddWithValue(<emphasis class="stringliteral">&quot;@SlorderNumber&quot;</emphasis>,&#32;SLorderNumber);
523 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.Parameters.Add(<emphasis class="keyword">new</emphasis>&#32;SqlParameter(<emphasis class="stringliteral">&quot;@xmldata&quot;</emphasis>,&#32;<link linkend="namespace_system">System</link>.Data.SqlDbType.Xml)&#32;{&#32;Value&#32;=&#32;new&#32;SqlXml(new&#32;XmlTextReader(xml.InnerXml,&#32;XmlNodeType.Document,&#32;null))&#32;});
524 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.CommandTimeout&#32;=&#32;120000;
525 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>.Open();
526 
528 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="comment">//if&#32;(database.Connection.State&#32;==&#32;ConnectionState.Connecting)</emphasis>
529 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="comment">//{</emphasis>
530 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="comment">//&#32;&#32;&#32;&#32;System.Threading.Thread.Sleep(1000);</emphasis>
531 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="comment">//}</emphasis>
532 
533 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.ExecuteNonQuery();
534 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>.Close();
535 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
536 
537 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a97a9d57d4ff36a700cc5233c5fdb9ac5_1a97a9d57d4ff36a700cc5233c5fdb9ac5">connectionString</link>&#32;=&#32;maintConnectionString;
538 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="comment">//to&#32;force&#32;the&#32;abstract&#32;class&#32;to&#32;reload&#32;our&#32;primary&#32;connnection&#32;string</emphasis>
539 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="comment">//database&#32;=&#32;new&#32;DbConnection();</emphasis>
540 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">using</emphasis>&#32;(<link linkend="class_triggers_1_1_db_connection">DbConnection</link>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;<link linkend="class_triggers_1_1_db_connection">DbConnection</link>())
541 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
542 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>.Open();
543 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>.Close();
544 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
545 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<link linkend="class_configure_one_flag_1_1_database_factory_a51459bb022678d9e0defecb0adb1ac15_1a51459bb022678d9e0defecb0adb1ac15">546 </link>&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">public</emphasis>&#32;<emphasis class="keyword">static</emphasis>&#32;<emphasis class="keywordtype">bool</emphasis>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a51459bb022678d9e0defecb0adb1ac15_1a51459bb022678d9e0defecb0adb1ac15">OrderCompleted</link>(<emphasis class="keywordtype">string</emphasis>&#32;order_num)
547 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
548 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordtype">bool</emphasis>&#32;rowExists&#32;=&#32;<emphasis class="keyword">false</emphasis>;
549 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="comment">//database&#32;=&#32;new&#32;DbConnection();</emphasis>
550 
551 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_aa5aa82b5ed9dd8d3610b92ed61a9f2d4_1aa5aa82b5ed9dd8d3610b92ed61a9f2d4">SQLCommand</link>&#32;=&#32;<emphasis class="stringliteral">&quot;Select&#32;order_num,&#32;co_num,&#32;stat&#32;from&#32;GR_CfgCO&#32;with(nolock)&#32;where&#32;order_num&#32;=&#32;@order_num&#32;and&#32;stat&#32;=&#32;&apos;C&apos;&#32;and&#32;co_num&#32;is&#32;not&#32;null&quot;</emphasis>;
552 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">using</emphasis>&#32;(<link linkend="class_triggers_1_1_db_connection">DbConnection</link>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;<link linkend="class_triggers_1_1_db_connection">DbConnection</link>())
553 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
554 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;SqlCommand(<link linkend="class_configure_one_flag_1_1_database_factory_aa5aa82b5ed9dd8d3610b92ed61a9f2d4_1aa5aa82b5ed9dd8d3610b92ed61a9f2d4">SQLCommand</link>,&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>);
555 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.CommandTimeout&#32;=&#32;120000;
556 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;SqlParameter&#32;ordernum&#32;=&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.Parameters.AddWithValue(<emphasis class="stringliteral">&quot;@order_num&quot;</emphasis>,&#32;order_num);
557 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>.Open();
558 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">using</emphasis>&#32;(SqlDataReader&#32;reader&#32;=&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.ExecuteReader())
559 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
560 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">if</emphasis>&#32;(reader.HasRows)
561 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
562 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;rowExists&#32;=&#32;<emphasis class="keyword">true</emphasis>;
563 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
564 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;reader.Close();
565 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
566 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>.Close();
567 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
568 
569 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">return</emphasis>&#32;rowExists;
570 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<link linkend="class_configure_one_flag_1_1_database_factory_a193fa120851ec2ce5d7632db4e875c65_1a193fa120851ec2ce5d7632db4e875c65">571 </link>&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">public</emphasis>&#32;<emphasis class="keyword">static</emphasis>&#32;<emphasis class="keywordtype">int</emphasis>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a193fa120851ec2ce5d7632db4e875c65_1a193fa120851ec2ce5d7632db4e875c65">CoLines</link>(<emphasis class="keywordtype">string</emphasis>&#32;SLOrderNumber)
572 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
573 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordtype">int</emphasis>&#32;coitems&#32;=&#32;0;
574 
575 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_aa5aa82b5ed9dd8d3610b92ed61a9f2d4_1aa5aa82b5ed9dd8d3610b92ed61a9f2d4">SQLCommand</link>&#32;=&#32;<emphasis class="stringliteral">&quot;Select&#32;ISNULL(COUNT(co_line),&#32;0)&#32;as&#32;lines&#32;From&#32;COITEM&#32;with(nolock)&#32;where&#32;co_num&#32;=&#32;@orderNumber&quot;</emphasis>;
576 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">using</emphasis>&#32;(<link linkend="class_triggers_1_1_db_connection">DbConnection</link>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;<link linkend="class_triggers_1_1_db_connection">DbConnection</link>())
577 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
578 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;SqlCommand(<link linkend="class_configure_one_flag_1_1_database_factory_aa5aa82b5ed9dd8d3610b92ed61a9f2d4_1aa5aa82b5ed9dd8d3610b92ed61a9f2d4">SQLCommand</link>,&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>);
579 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.CommandTimeout&#32;=&#32;120000;
580 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;SqlParameter&#32;ordernum&#32;=&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.Parameters.AddWithValue(<emphasis class="stringliteral">&quot;@orderNumber&quot;</emphasis>,&#32;SLOrderNumber);
581 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>.Open();
582 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">using</emphasis>&#32;(SqlDataReader&#32;reader&#32;=&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.ExecuteReader())
583 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
584 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;reader.Read();
585 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;coitems&#32;=&#32;Convert.ToInt16(reader[<emphasis class="stringliteral">&quot;lines&quot;</emphasis>].ToString());
586 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;reader.Close();
587 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
588 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>.Close();
589 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
590 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">return</emphasis>&#32;coitems;
591 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<link linkend="class_configure_one_flag_1_1_database_factory_adb8f7b260d9ace708051700d1e20528f_1adb8f7b260d9ace708051700d1e20528f">592 </link>&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">public</emphasis>&#32;<emphasis class="keyword">static</emphasis>&#32;<emphasis class="keywordtype">void</emphasis>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_adb8f7b260d9ace708051700d1e20528f_1adb8f7b260d9ace708051700d1e20528f">ExecutePreCache</link>()
593 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
594 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="comment">//Execute&#32;Pre-caching&#32;of&#32;the&#32;SP&apos;s&#32;to&#32;force&#32;an&#32;on-demand&#32;recompile&#32;while&#32;we&#32;are&#32;preparing</emphasis>
595 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordtype">int</emphasis>&#32;CreateOrder&#32;=&#32;1;
596 
597 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">using</emphasis>&#32;(<link linkend="class_triggers_1_1_db_connection">DbConnection</link>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;<link linkend="class_triggers_1_1_db_connection">DbConnection</link>())
598 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
599 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;SqlCommand(<emphasis class="stringliteral">&quot;GR_CfgImportSp&quot;</emphasis>,&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>);
600 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.CommandType&#32;=&#32;CommandType.StoredProcedure;
601 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.Parameters.AddWithValue(<emphasis class="stringliteral">&quot;@pStartingOrderNum&quot;</emphasis>,&#32;<emphasis class="stringliteral">&quot;PRECACHE&quot;</emphasis>);
602 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.Parameters.AddWithValue(<emphasis class="stringliteral">&quot;@pEndingOrderNum&quot;</emphasis>,&#32;<emphasis class="stringliteral">&quot;PRECACHE&quot;</emphasis>);
603 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.Parameters.AddWithValue(<emphasis class="stringliteral">&quot;@pCreateOrder&quot;</emphasis>,&#32;CreateOrder);
604 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.CommandTimeout&#32;=&#32;120000;
605 
606 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>.Open();
607 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.ExecuteNonQuery();
608 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>.Close();
609 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
610 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<link linkend="class_configure_one_flag_1_1_database_factory_a4c86e61821f40ef2483dde7fbf125710_1a4c86e61821f40ef2483dde7fbf125710">611 </link>&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">public</emphasis>&#32;<emphasis class="keyword">static</emphasis>&#32;<emphasis class="keywordtype">bool</emphasis>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4c86e61821f40ef2483dde7fbf125710_1a4c86e61821f40ef2483dde7fbf125710">OrderExists</link>(<emphasis class="keywordtype">string</emphasis>&#32;C1orderNum)
612 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
613 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordtype">bool</emphasis>&#32;orderExists&#32;=&#32;<emphasis class="keyword">false</emphasis>;
614 
615 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_aa5aa82b5ed9dd8d3610b92ed61a9f2d4_1aa5aa82b5ed9dd8d3610b92ed61a9f2d4">SQLCommand</link>&#32;=&#32;<emphasis class="stringliteral">&quot;Select&#32;TOP&#32;1&#32;co_num&#32;as&#32;SLCO&#32;From&#32;CO&#32;c&#32;with&#32;(nolock)&#32;Where&#32;c.uf_weborder&#32;=&#32;@C1OrderNum&#32;Order&#32;By&#32;c.order_date&#32;desc,&#32;c.co_num&#32;desc&quot;</emphasis>;
616 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">using</emphasis>&#32;(<link linkend="class_triggers_1_1_db_connection">DbConnection</link>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;<link linkend="class_triggers_1_1_db_connection">DbConnection</link>())
617 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
618 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;SqlCommand(<link linkend="class_configure_one_flag_1_1_database_factory_aa5aa82b5ed9dd8d3610b92ed61a9f2d4_1aa5aa82b5ed9dd8d3610b92ed61a9f2d4">SQLCommand</link>,&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>);
619 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.CommandTimeout&#32;=&#32;120000;
620 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;SqlParameter&#32;c1ordernum&#32;=&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.Parameters.AddWithValue(<emphasis class="stringliteral">&quot;@C1OrderNum&quot;</emphasis>,&#32;C1orderNum);
621 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>.Open();
622 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">using</emphasis>&#32;(SqlDataReader&#32;reader&#32;=&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.ExecuteReader())
623 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
624 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">if</emphasis>&#32;(reader.HasRows)
625 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
626 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">if</emphasis>&#32;(reader.Read())
627 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
628 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;orderExists&#32;=&#32;<emphasis class="keyword">true</emphasis>;
629 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
630 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
631 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;reader.Close();
632 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
633 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>.Close();
634 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
635 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">return</emphasis>&#32;orderExists;
636 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<link linkend="class_configure_one_flag_1_1_database_factory_ad0311ab55adaa79f6211e1377ad7d65e_1ad0311ab55adaa79f6211e1377ad7d65e">637 </link>&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">public</emphasis>&#32;<emphasis class="keyword">static</emphasis>&#32;<emphasis class="keywordtype">string</emphasis>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_ad0311ab55adaa79f6211e1377ad7d65e_1ad0311ab55adaa79f6211e1377ad7d65e">CustomerOnHold</link>(<emphasis class="keywordtype">string</emphasis>&#32;custnum,&#32;<emphasis class="keywordtype">string</emphasis>&#32;seq)
638 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
639 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordtype">string</emphasis>&#32;holdReason&#32;=&#32;<emphasis class="stringliteral">&quot;&quot;</emphasis>;
640 
641 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_aa5aa82b5ed9dd8d3610b92ed61a9f2d4_1aa5aa82b5ed9dd8d3610b92ed61a9f2d4">SQLCommand</link>&#32;=&#32;<emphasis class="stringliteral">&quot;Select&#32;uf_coholddescription&#32;From&#32;customer&#32;cust&#32;with&#32;(nolock)&#32;Where&#32;ltrim(rtrim(cust.cust_num))&#32;=&#32;@custnum&#32;and&#32;cust_seq&#32;=&#32;@seq&#32;and&#32;uf_cohold&#32;=&#32;1&quot;</emphasis>;
642 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">using</emphasis>&#32;(<link linkend="class_triggers_1_1_db_connection">DbConnection</link>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;<link linkend="class_triggers_1_1_db_connection">DbConnection</link>())
643 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
644 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;SqlCommand(<link linkend="class_configure_one_flag_1_1_database_factory_aa5aa82b5ed9dd8d3610b92ed61a9f2d4_1aa5aa82b5ed9dd8d3610b92ed61a9f2d4">SQLCommand</link>,&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>);
645 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.CommandTimeout&#32;=&#32;120000;
646 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;SqlParameter&#32;CustNumber&#32;=&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.Parameters.AddWithValue(<emphasis class="stringliteral">&quot;@custnum&quot;</emphasis>,&#32;custnum);
647 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;SqlParameter&#32;CustSeq&#32;=&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.Parameters.AddWithValue(<emphasis class="stringliteral">&quot;@seq&quot;</emphasis>,&#32;seq);
648 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>.Open();
649 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">using</emphasis>&#32;(SqlDataReader&#32;reader&#32;=&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.ExecuteReader())
650 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
651 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">if</emphasis>&#32;(reader.HasRows)
652 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
653 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">if</emphasis>&#32;(reader.Read())
654 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
655 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;holdReason&#32;=&#32;reader[<emphasis class="stringliteral">&quot;uf_coholddescription&quot;</emphasis>].ToString();
656 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="namespace_triggers">Triggers</link>.logEvent&#32;=&#32;<emphasis class="stringliteral">&quot;Found&#32;an&#32;on-hold&#32;record&#32;match&quot;</emphasis>;
657 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="namespace_system">System</link>.Diagnostics.EventLog.WriteEntry(<link linkend="namespace_triggers">Triggers</link>.logSource,&#32;<link linkend="namespace_triggers">Triggers</link>.logEvent,&#32;<link linkend="namespace_system">System</link>.Diagnostics.EventLogEntryType.Information,&#32;234);
658 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
659 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
660 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;reader.Close();
661 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
662 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>.Close();
663 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
664 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">return</emphasis>&#32;holdReason;
665 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<link linkend="class_configure_one_flag_1_1_database_factory_a6fba3443de3b8beba6d0648a75bff168_1a6fba3443de3b8beba6d0648a75bff168">666 </link>&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">public</emphasis>&#32;<emphasis class="keyword">static</emphasis>&#32;<emphasis class="keywordtype">void</emphasis>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a6fba3443de3b8beba6d0648a75bff168_1a6fba3443de3b8beba6d0648a75bff168">MoveQueueRecord</link>(<emphasis class="keywordtype">string</emphasis>&#32;orderNum,&#32;<emphasis class="keywordtype">string</emphasis>&#32;dbSite)
667 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
668 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">try</emphasis>
669 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
670 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="comment">//Disable&#32;trigger&#32;on&#32;target&#32;database/table,&#32;copy&#32;queue&#32;record,&#32;delete&#32;from&#32;NOVB</emphasis>
671 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_aa5aa82b5ed9dd8d3610b92ed61a9f2d4_1aa5aa82b5ed9dd8d3610b92ed61a9f2d4">SQLCommand</link>&#32;=&#32;<emphasis class="stringliteral">&quot;DISABLE&#32;TRIGGER&#32;C1Order&#32;ON&#32;SL_&quot;</emphasis>&#32;+&#32;dbSite&#32;+&#32;<emphasis class="stringliteral">&quot;_App.dbo.GR_Cfg_Queue&quot;</emphasis>;
672 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">using</emphasis>&#32;(<link linkend="class_triggers_1_1_db_connection">DbConnection</link>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;<link linkend="class_triggers_1_1_db_connection">DbConnection</link>())
673 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
674 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;SqlCommand(<link linkend="class_configure_one_flag_1_1_database_factory_aa5aa82b5ed9dd8d3610b92ed61a9f2d4_1aa5aa82b5ed9dd8d3610b92ed61a9f2d4">SQLCommand</link>,&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>);
675 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.CommandTimeout&#32;=&#32;120000;
676 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>.Open();
677 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.ExecuteNonQuery();
678 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
679 
680 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordtype">string</emphasis>&#32;recordRowPointer&#32;=&#32;<emphasis class="stringliteral">&quot;&quot;</emphasis>;
681 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_aa5aa82b5ed9dd8d3610b92ed61a9f2d4_1aa5aa82b5ed9dd8d3610b92ed61a9f2d4">SQLCommand</link>&#32;=&#32;<emphasis class="stringliteral">&quot;SELECT&#32;TOP&#32;1&#32;rowpointer&#32;from&#32;SL_NOVB_App.dbo.GR_Cfg_Queue&#32;where&#32;order_num&#32;=&#32;@orderNum&#32;order&#32;by&#32;recorddate&#32;desc&quot;</emphasis>;
682 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">using</emphasis>&#32;(<link linkend="class_triggers_1_1_db_connection">DbConnection</link>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;<link linkend="class_triggers_1_1_db_connection">DbConnection</link>())
683 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
684 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;SqlCommand(<link linkend="class_configure_one_flag_1_1_database_factory_aa5aa82b5ed9dd8d3610b92ed61a9f2d4_1aa5aa82b5ed9dd8d3610b92ed61a9f2d4">SQLCommand</link>,&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>);
685 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.CommandTimeout&#32;=&#32;120000;
686 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;SqlParameter&#32;CustNumber&#32;=&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.Parameters.AddWithValue(<emphasis class="stringliteral">&quot;@orderNum&quot;</emphasis>,&#32;orderNum);
687 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>.Open();
688 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">using</emphasis>&#32;(SqlDataReader&#32;reader&#32;=&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.ExecuteReader())
689 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
690 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">if</emphasis>&#32;(reader.HasRows)
691 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
692 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">if</emphasis>&#32;(reader.Read())&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="comment">//this&#32;should&#32;never&#32;NOT&#32;happen&#32;(ok&#32;that&apos;s&#32;a&#32;little&#32;obtuse.&#32;&#32;How&#32;about:&#32;This&#32;should&#32;ALWAYS&#32;happen)</emphasis>
693 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
694 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="comment">//Copy&#32;this&#32;record&#32;to&#32;the&#32;target&#32;site&#32;DB</emphasis>
695 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;recordRowPointer&#32;=&#32;reader[<emphasis class="stringliteral">&quot;rowpointer&quot;</emphasis>].ToString();
696 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;reader.Close();
697 
698 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_aa5aa82b5ed9dd8d3610b92ed61a9f2d4_1aa5aa82b5ed9dd8d3610b92ed61a9f2d4">SQLCommand</link>&#32;=&#32;<emphasis class="stringliteral">&quot;insert&#32;into&#32;SL_&quot;</emphasis>&#32;+&#32;dbSite&#32;+&#32;<emphasis class="stringliteral">&quot;_App.dbo.GR_Cfg_Queue&#32;Select&#32;*&#32;from&#32;SL_NOVB_App.dbo.GR_Cfg_Queue&#32;where&#32;rowpointer&#32;=&#32;@recordrowpointer&quot;</emphasis>;
699 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">using</emphasis>&#32;(<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>)
700 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
701 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;SqlCommand(<link linkend="class_configure_one_flag_1_1_database_factory_aa5aa82b5ed9dd8d3610b92ed61a9f2d4_1aa5aa82b5ed9dd8d3610b92ed61a9f2d4">SQLCommand</link>,&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>);
702 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.CommandTimeout&#32;=&#32;120000;
703 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;SqlParameter&#32;RecRowPointer&#32;=&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.Parameters.AddWithValue(<emphasis class="stringliteral">&quot;@recordrowpointer&quot;</emphasis>,&#32;recordRowPointer);
704 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>.Open();
705 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.ExecuteNonQuery();
706 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
707 
708 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_aa5aa82b5ed9dd8d3610b92ed61a9f2d4_1aa5aa82b5ed9dd8d3610b92ed61a9f2d4">SQLCommand</link>&#32;=&#32;<emphasis class="stringliteral">&quot;DELETE&#32;From&#32;SL_NOVB_App.dbo.GR_Cfg_Queue&#32;where&#32;rowpointer&#32;=&#32;@recordrowpointer&quot;</emphasis>;
709 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">using</emphasis>&#32;(<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>)
710 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
711 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;SqlCommand(<link linkend="class_configure_one_flag_1_1_database_factory_aa5aa82b5ed9dd8d3610b92ed61a9f2d4_1aa5aa82b5ed9dd8d3610b92ed61a9f2d4">SQLCommand</link>,&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>);
712 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.CommandTimeout&#32;=&#32;120000;
713 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;SqlParameter&#32;RecRowPointer&#32;=&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.Parameters.AddWithValue(<emphasis class="stringliteral">&quot;@recordrowpointer&quot;</emphasis>,&#32;recordRowPointer);
714 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>.Open();
715 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.ExecuteNonQuery();
716 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>.Close();
717 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
718 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
719 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
720 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
721 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
722 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="namespace_triggers">Triggers</link>.logEvent&#32;=&#32;<emphasis class="stringliteral">&quot;Queue&#32;record&#32;was&#32;moved&#32;to&#32;SL_&quot;</emphasis>&#32;+&#32;<link linkend="class_configure_one_flag_1_1_staging_utilities">StagingUtilities</link>.<link linkend="class_configure_one_flag_1_1_staging_utilities_a4bbfcbf56b350859fc9a8ca73f3c3c4c_1a4bbfcbf56b350859fc9a8ca73f3c3c4c">dbSite</link>&#32;+&#32;<emphasis class="stringliteral">&quot;_App.dbo.GR_Cfg_Queue&quot;</emphasis>;
723 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="namespace_system">System</link>.Diagnostics.EventLog.WriteEntry(<link linkend="namespace_triggers">Triggers</link>.logSource,&#32;<link linkend="namespace_triggers">Triggers</link>.logEvent,&#32;<link linkend="namespace_system">System</link>.Diagnostics.EventLogEntryType.Information,&#32;234);
724 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
725 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">catch</emphasis>&#32;(Exception&#32;mqEx)
726 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
727 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="comment">//Log&#32;and&#32;ignore&#32;the&#32;error&#32;and&#32;move&#32;on&#32;with&#32;re-enabling&#32;the&#32;trigger</emphasis>
728 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordtype">string</emphasis>&#32;logEvent&#32;=&#32;<emphasis class="stringliteral">&quot;An&#32;error&#32;occurred&#32;while&#32;attempting&#32;to&#32;move&#32;the&#32;queue&#32;record&#32;to&#32;&quot;</emphasis>&#32;+&#32;<link linkend="class_configure_one_flag_1_1_staging_utilities">StagingUtilities</link>.<link linkend="class_configure_one_flag_1_1_staging_utilities_a4bbfcbf56b350859fc9a8ca73f3c3c4c_1a4bbfcbf56b350859fc9a8ca73f3c3c4c">dbSite</link>&#32;+&#32;<emphasis class="stringliteral">&quot;:&#32;&quot;</emphasis>&#32;+&#32;mqEx.Message;
729 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="namespace_system">System</link>.Diagnostics.EventLog.WriteEntry(<link linkend="namespace_triggers">Triggers</link>.logSource,&#32;logEvent,&#32;<link linkend="namespace_system">System</link>.Diagnostics.EventLogEntryType.Warning,&#32;234);
730 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
731 
732 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="comment">//Re-enable&#32;trigger&#32;on&#32;db&#32;site&#32;queue&#32;table</emphasis>
733 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_aa5aa82b5ed9dd8d3610b92ed61a9f2d4_1aa5aa82b5ed9dd8d3610b92ed61a9f2d4">SQLCommand</link>&#32;=&#32;<emphasis class="stringliteral">&quot;ENABLE&#32;TRIGGER&#32;C1Order&#32;ON&#32;SL_&quot;</emphasis>&#32;+&#32;dbSite&#32;+&#32;<emphasis class="stringliteral">&quot;_App.dbo.GR_Cfg_Queue&quot;</emphasis>;
734 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keyword">using</emphasis>&#32;(<link linkend="class_triggers_1_1_db_connection">DbConnection</link>&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;<link linkend="class_triggers_1_1_db_connection">DbConnection</link>())
735 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
736 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;SqlCommand(<link linkend="class_configure_one_flag_1_1_database_factory_aa5aa82b5ed9dd8d3610b92ed61a9f2d4_1aa5aa82b5ed9dd8d3610b92ed61a9f2d4">SQLCommand</link>,&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>);
737 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.CommandTimeout&#32;=&#32;120000;
738 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_ad2de26dae4b5e20a805a9342b2fa16d3_1ad2de26dae4b5e20a805a9342b2fa16d3">Connection</link>.Open();
739 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="class_configure_one_flag_1_1_database_factory_a4795a2107c9c5f717b3831246505cb2e_1a4795a2107c9c5f717b3831246505cb2e">database</link>.<link linkend="class_triggers_1_1ab_database_a18245991d3f202764179f8cfb8ada0b5_1a18245991d3f202764179f8cfb8ada0b5">Command</link>.ExecuteNonQuery();
740 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
741 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
742 &#32;&#32;&#32;&#32;}
743 }
744 
    </computeroutput></literallayout>
</section>
